/*
	Finch.js - Powerfully simple javascript routing
	by Rick Allen (stoodder) and Greg Smith (smrq)

	Version 0.5.2
	Full source at https://github.com/stoodder/finchjs
	Copyright (c) 2011 RokkinCat, http://www.rokkincat.com

	MIT License, https://github.com/stoodder/finchjs/blob/master/LICENSE.md
	This file is generated by `cake build`, do not edit it by hand.
*/
((function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ba,bb,bc,bd,be,bf=Array.prototype.slice;M=function(a){return typeof a==typeof {}&&a!==null},K=function(a){return Object.prototype.toString.call(a)==="[object Function]"},J=function(a){return Object.prototype.toString.call(a)==="[object Boolean]"},I=function(a){return Object.prototype.toString.call(a)==="[object Array]"},N=function(a){return Object.prototype.toString.call(a)==="[object String]"},L=function(a){return Object.prototype.toString.call(a)==="[object Number]"},bd=function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},be=function(a){return a.replace(/^\//,"").replace(/\/$/,"")},Z=function(a,b){return a.indexOf(b)===0},A=function(a,b){return a.indexOf(b,a.length-b.length)!==-1},x=function(a,b){var c,d,e;if(K(a.indexOf))return a.indexOf(b)!==-1;if(I(a))for(d=0,e=a.length;d<e;d++){c=a[d];if(c===b)return!0}return!1},U=function(a){return a[a.length-1]},y=function(a,b){return a.split(b).length-1},O=function(a){var b,c;c=[];for(b in a)c.push(b);return c},P=function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(c);return d},B=function(a,b){var c,d;M(a)||(a={}),M(b)||(b={});for(c in b)d=b[c],a[c]=d;return a},w=function(a){var b,c,d;M(a)||(a={}),c={};for(b in a)d=a[b],d!=null&&(c[b]=d);return c},Q=function(a,b){var c,d;for(c in a){d=a[c];if(b[c]!==d)return!1}for(c in b){d=b[c];if(a[c]!==d)return!1}return!0},v=function(a,b){var c,d,e;if(a.length!==b.length)return!1;for(c=0,e=a.length;c<e;c++){d=a[c];if(b[c]!==d)return!1}return!0},z=function(a,b){var c,d,e;a==null&&(a={}),b==null&&(b={}),d={};for(c in a)e=a[c],b[c]!==e&&(d[c]=b[c]);for(c in b)e=b[c],a[c]!==e&&(d[c]=e);return d};if(typeof console=="undefined"||console===null)console={};console.log==null&&(console.log=function(){}),console.warn==null&&(console.warn=function(){}),n=function(){function a(a){var b,c;c=a.components,b=a.childIndex,this.components=c!=null?c:[],this.childIndex=b!=null?b:0}return a}(),q=function(){function a(a){var b,c,d,e;e=a!=null?a:{},b=e.name,c=e.nodeType,d=e.parent,this.name=b!=null?b:"",this.nodeType=c!=null?c:null,this.parent=d!=null?d:null,this.routeSettings=null,this.childLiterals={},this.childVariable=null,this.bindings=[]}return a}(),s=function(){function a(a){var b,c,d,e,f,g;g=a!=null?a:{},d=g.setup,e=g.teardown,c=g.load,f=g.unload,b=g.context,this.setup=K(d)?d:function(){},this.load=K(c)?c:function(){},this.unload=K(f)?f:function(){},this.teardown=K(e)?e:function(){},this.context=M(b)?b:{}}return a}(),r=function(){function a(a){var b,c,d,e;e=a!=null?a:{},c=e.node,b=e.boundValues,d=e.parameterObservables,this.node=c!=null?c:null,this.boundValues=b!=null?b:[],this.parameterObservables=d!=null?d:[[]]}return a.prototype.getBindings=function(){var a,b,c,d,e;b={},e=this.node.bindings;for(c=0,d=e.length;c<d;c++)a=e[c],b[a]=this.boundValues[c];return R(b)},a.prototype.isEqual=function(a){return a!=null&&this.node===a.node&&v(this.boundValues,a.boundValues)},a.prototype.isRoot=function(){return this.node.parent==null},a.prototype.getParent=function(){var b,c,d,e,f;return this.node==null?null:(b=(e=(f=this.node.parent)!=null?f.bindings.length:void 0)!=null?e:0,c=this.boundValues.slice(0,b),d=this.parameterObservables.slice(0,-1),new a({node:this.node.parent,boundValues:c,parameterObservables:d}))},a.prototype.getChild=function(a){var b;while(a!=null&&!this.isEqual(b=a.getParent()))a=b;return a.parameterObservables=this.parameterObservables.slice(0),a.parameterObservables.push([]),a},a}(),m=function(){function a(a){this.callback=a,K(this.callback)||(this.callback=function(){}),this.dependencies=[],this.initialized=!1}return a.prototype.notify=function(a){var b,c=this;b=function(){var b,d,e,f;if(!c.initialized)return!0;f=c.dependencies;for(d=0,e=f.length;d<e;d++){b=f[d];if(x(a,b))return!0}return!1}();if(b)return this.trigger()},a.prototype.trigger=function(){var a,c=this;return this.dependencies=[],a=function(a){return x(c.dependencies,a)||c.dependencies.push(a),b[a]},this.callback(a),this.initialized=!0},a}(),k=new r({node:null}),j={Literal:"Literal",Variable:"Variable"},S=function(a){var b,c,d,e,f,g,h,i;a=N(a)?bd(a):"",d={};if(a!==""){h=a.split("&");for(f=0,g=h.length;f<g;f++)c=h[f],i=c.split("=",2),b=i[0],e=i[1],d[b]=e}return R(d)},G=function(){var a;return"#"+((a=window.location.href.split("#",2)[1])!=null?a:"")},X=function(a){return N(a)||(a=""),a=bd(a),a.slice(0,1)==="#"&&(a=a.slice(1)),window.location.hash=a},R=function(a){var b,c;M(a)||(a={});if(l.CoerceParameterTypes)for(b in a)c=a[b],c==="true"?c=!0:c==="false"?c=!1:/^[0-9]+$/.test(c)?c=parseInt(c):/^[0-9]+\.[0-9]*$/.test(c)&&(c=parseFloat(c)),a[b]=c;return a},Y=function(a){var b;return a=be(a),b=a===""?[]:a.split("/"),b.unshift("/"),b},T=function(a){var b,c,d,e,f,g,h,i,j;f=x(a,"[")||x(a,"]"),f&&function(){var b,c;c=y(a,"[");if(c!==1)return c>1&&console.warn('Parsing failed on "'+a+'": Extra ['),c<1&&console.warn('Parsing failed on "'+a+'": Missing ['),null;b=y(a,"]");if(b!==1)return b>1&&console.warn('Parsing failed on "'+a+'": Extra ]'),b<1&&console.warn('Parsing failed on "'+a+'": Missing ]'),null;if(!Z(a,"["))return console.warn('Parsing failed on "'+a+'": [ not at beginning'),null}(),e=a.replace(/[\[\]]/g,""),e===""?d=[]:d=Y(e);for(i=0,j=d.length;i<j;i++){c=d[i];if(c==="")return console.warn('Parsing failed on "'+a+'": Blank component'),null}b=0;if(f){h=a.split("]")[0],g=Y(h.replace("[",""));if(g[g.length-1]!==d[g.length-1])return console.warn('Parsing failed on "'+a+'": ] in the middle of a component'),null;if(g.length===d.length)return console.warn('Parsing failed on "'+a+'": No child components'),null;b=g.length}return new n({components:d,childIndex:b})},F=function(a){return Z(a,":")?j.Variable:j.Literal},E=function(a){switch(F(a)){case j.Literal:return a;case j.Variable:return a.slice(1)}},u=function(a,b,c){var d,e,f,g,h;return f=b.components,e=b.childIndex,g=a,d=[],(h=function(i,k){var l,m,n,o,p,r,t;k===e&&(g=i);if(b.components.length<=0)return i.parent=g,i.bindings=d,i.routeSettings=new s(c);l=f.shift(),n=F(l),m=E(l);switch(n){case j.Literal:o=(r=(p=i.childLiterals)[m])!=null?r:p[m]=new q({name:""+i.name+l+"/",nodeType:n,parent:a});break;case j.Variable:o=(t=i.childVariable)!=null?t:i.childVariable=new q({name:""+i.name+l+"/",nodeType:n,parent:a}),d.push(m)}return h(o,k+1)})(a,0)},D=function(a,b){var c,d,e;return e=Y(b),c=[],(d=function(a,b){var e,f;if(b.length<=0&&a.routeSettings!=null)return new r({node:a,boundValues:c});e=b[0];if(a.childLiterals[e]!=null){f=d(a.childLiterals[e],b.slice(1));if(f!=null)return f}if(a.childVariable!=null){c.push(e),f=d(a.childVariable,b.slice(1));if(f!=null)return f;c.pop()}return null})(a,e)},C=function(a,b){var c,d,e,f,g;d=[],e=b;while(e!=null)d.push(e),e=e.getParent();e=a;while(e!=null){for(f=0,g=d.length;f<g;f++){c=d[f];if(e.isEqual(c))return e}e=e.getParent()}return null},p=c=d=null,o=b=null,f=a=null,g=!1,h=t=!1,i=!1,l={CoerceParameterTypes:!1},(V=function(){return p=new q({name:"*"}),c=k,o={},b={},d=null,f=null,a=null,g=!1,h=!1,t=!1,i=!1})(),$=function(){var a;return d===null?W():i?bc():d.isEqual(c)?_():(a=C(c,d),c.isEqual(a)?ba():bb())},ba=function(){var a,b,e,f,g,h,i,j,k,l;return t=!0,f=((i=(j=c.node)!=null?j.routeSettings:void 0)!=null?i:{context:null}).context,c=c.getChild(d),l=(k=c.node.routeSettings)!=null?k:{},b=l.context,h=l.setup,e=l.load,b==null&&(b={}),b.parent=f,h==null&&(h=function(){}),e==null&&(e=function(){}),a=c.getBindings(),g=function(){return $()},h.length===2?h.call(b,a,g):(h.call(b,a),g())},_=function(){var a,b,e,f,g,h,j;return f=function(){return i=!0,d=null,$()},c.node==null?f():(j=(h=c.node.routeSettings)!=null?h:{},b=j.context,g=j.setup,e=j.load,b==null&&(b={}),g==null&&(g=function(){}),e==null&&(e=function(){}),a=c.getBindings(),e.length===2?e.call(b,a,f):(e.call(b,a),f()))},bc=function(){var a,b,d,e,f,g;return i=!1,d=function(){return $()},g=(f=c.node.routeSettings)!=null?f:{},b=g.context,e=g.unload,b==null&&(b={}),e==null&&(e=function(){}),a=c.getBindings(),e.length===2?e.call(b,a,d):(e.call(b,a),d())},bb=function(){var a,b,d,e,f,g;return t=!1,g=(f=c.node.routeSettings)!=null?f:{},b=g.context,e=g.teardown,b==null&&(b={}),e==null&&(e=function(){}),a=c.getBindings(),d=function(){return c=c.getParent(),$()},e.length===2?e.call(b,a,d):(e.call(b,a),d())},W=function(){var a,d,e,f,g,h,i;a=O(z(o,b)),o=b,h=c.parameterObservables,i=[];for(f=0,g=h.length;f<g;f++)e=h[f],i.push(function(){var b,c,f;f=[];for(b=0,c=e.length;b<c;b++)d=e[b],f.push(d.notify(a));return f}());return i},H=function(b){var c;c=G(),Z(c,"#")&&(c=c.slice(1)),c=unescape(c);if(c!==a)return e.call(c)?a=c:X(a!=null?a:"")},e={route:function(a,b){var c,d;return K(b)&&(c=b,b={setup:c},c.length===2?b.load=function(a,b){return t?b():(h=!0,c(a,b))}:b.load=function(a){if(!t)return h=!0,c(a)}),M(b)||(b={}),N(a)||(a=""),a=bd(a),a.length>0||(a="/"),d=T(a),d==null?!1:(u(p,d,b),!0)},call:function(a){var e,f,g,h,i,j;return N(a)||(a="/"),a===""&&(a="/"),j=a.split("?",2),a=j[0],i=j[1],f=D(p,a),f==null?!1:(h=S(i),e=f.getBindings(),b=B(h,e),d===null&&c.isEqual(f)?$():(g=d,d=f,g==null&&$()),!0)},reload:function(){return i?c==null||c.node==null?this:(d=c,$(),this):this},observe:function(){var a,b,d,f;return a=1<=arguments.length?bf.call(arguments,0):[],h?h=!1:(b=a.pop(),K(b)||(b=function(){}),a.length>0?(a.length===1&&I(a[0])?d=a[0]:d=a,e.observe(function(a){var c,e;return e=function(){var b,e,f;f=[];for(b=0,e=d.length;b<e;b++)c=d[b],f.push(a(c));return f}(),b.apply(null,e)})):(f=new m(b),U(c.parameterObservables).push(f)))},abort:function(){return d=null},listen:function(){return g||("onhashchange"in window&&(K(window.addEventListener)?(window.addEventListener("hashchange",H,!0),g=!0):K(window.attachEvent)&&(window.attachEvent("hashchange",H),g=!0)),g||(f=setInterval(H,33),g=!0),H()),g},ignore:function(){return g&&(f!==null?(clearInterval(f),f=null,g=!1):"onhashchange"in window&&(K(window.removeEventListener)?(window.removeEventListener("hashchange",H,!0),g=!1):K(window.detachEvent)&&(window.detachEvent("hashchange",H),g=!1))),!g},navigate:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;o=G().split("?",2),g=o[0],f=o[1],g==null&&(g=""),f==null&&(f=""),g.slice(0,1)==="#"&&(g=g.slice(1)),g=unescape(g),e=S(f),J(b)&&(c=b),M(a)&&(b=a),N(a)||(a=""),M(b)||(b={}),J(c)||(c=!1),a=bd(a),a.length===0&&(a=null),c&&(function(){var a,b,c;b={};for(a in e)c=e[a],b[unescape(a)]=unescape(c);return e=b}(),b=B(e,b)),a===null&&(a=g),p=a.split("?",2),a=p[0],l=p[1],a.slice(0,1)==="#"&&(a=a.slice(1));if(Z(a,"./")||Z(a,"../")){d=g;while(Z(a,"./")||Z(a,"../"))k=a.indexOf("/"),i=a.slice(0,k),a=a.slice(k+1),i===".."&&(d=d.slice(0,d.lastIndexOf("/")));a=a.length>0?""+d+"/"+a:d}return m=N(l)?S(l):{},b=B(m,b),b=w(b),a=escape(a),j=function(){var a;a=[];for(h in b)n=b[h],a.push(escape(h)+"="+escape(n));return a}().join("&"),j.length>0&&(a+="?"+j),X(a)},reset:function(){e.options({CoerceParameterTypes:!1}),d=k,$(),e.ignore(),V()},options:function(a){return B(l,a)}},this.Finch=e})).call(this)